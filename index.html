<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="theme-color" content="#0b0d10"/>
<link rel="manifest" href="manifest.json">
<title>PitStop Pro v3</title>
<style>
body{margin:0;font-family:sans-serif;background:#0b0d10;color:#eee}
header{padding:12px;background:#111;border-bottom:1px solid #333;position:sticky;top:0}
h1{margin:0;font-size:20px}
.tabs{display:flex;gap:8px;margin-top:8px}
.tab{flex:1;text-align:center;padding:8px;background:#222;color:#aaa;cursor:pointer;border-radius:6px}
.tab.active{background:#333;color:#fff}
main{padding:12px}
.card{background:#15181c;padding:12px;border-radius:10px;margin-bottom:12px}
</style>
</head>
<body>
<header>
  <h1>üöö PitStop Pro v3</h1>
  <div class="tabs">
    <div class="tab active" data-tab="overview">Overview</div>
    <div class="tab" data-tab="shifts">Shifts</div>
    <div class="tab" data-tab="export">Export</div>
  </div>
</header>
<main>
<section id="overview" class="view">
  <div class="card"><h3>Dashboard (simulado)</h3>
    <p>üöõ Total km: <b>12.450</b></p>
    <p>‚è±Ô∏è Horas: <b>185h</b></p>
    <p>üìÖ Turnos: <b>28</b></p>
    <p>‚ö° M√©dia: <b>445 km/turno</b></p>
    <canvas id="bar" width="300" height="150"></canvas>
    <canvas id="pie" width="300" height="150"></canvas>
  </div>
</section>
<section id="shifts" class="view" style="display:none">
  <div class="card">
    <h3>Shift exemplo</h3>
    <p>Start: Rotterdam, NL (km 314000)</p>
    <p>End: Milan, IT (km 314850)</p>
    <p>Dura√ß√£o: 9h20m ‚Äî Dist: 850 km</p>
    <button onclick="genPDF()">Gerar PDF A5</button>
  </div>
</section>
<section id="export" class="view" style="display:none">
  <div class="card"><button onclick="alert('Export CSV simulado')">Export CSV</button></div>
</section>
</main>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script>
// Tabs
document.querySelectorAll('.tab').forEach(t=>t.onclick=()=>{
  document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
  t.classList.add('active');
  document.querySelectorAll('.view').forEach(v=>v.style.display='none');
  document.getElementById(t.dataset.tab).style.display='block';
});

// Charts fake
new Chart(document.getElementById('bar'),{type:'bar',data:{labels:['Wk1','Wk2','Wk3','Wk4'],datasets:[{label:'Km',data:[2800,3100,2900,2650],backgroundColor:'deepskyblue'}]}});
new Chart(document.getElementById('pie'),{type:'pie',data:{labels:['Rotterdam-Milan','Antwerp-Hamburg','Rotterdam-Paris'],datasets:[{data:[12,9,7],backgroundColor:['orange','lightgreen','lightblue']} ]}});

// PDF export simulado
async function genPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({format:'a5'});
  doc.text("Shift Report - Rotterdam to Milan",10,10);
  doc.text("Start: Rotterdam, NL - km 314000",10,20);
  doc.text("End: Milan, IT - km 314850",10,30);
  doc.text("Distance: 850 km | Duration: 9h20m",10,40);
  // mini-mapa simulado (print da div card)
  const card = document.querySelector('#shifts .card');
  const canvas = await html2canvas(card);
  const img = canvas.toDataURL("image/png");
  doc.addImage(img,'PNG',10,50,120,60);
  doc.save("shift.pdf");
}
</script>
</body>
</html>
